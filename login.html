<!DOCTYPE html>
<html>
<head>
  <title>LoveSongs App</title>
  <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-analytics.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
  import { getFirestore, collection, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyCOed1uYtjzkR1OpYS6z3-sbIVPQW6MohM",
    authDomain: "lovesongs-1285e.firebaseapp.com",
    projectId: "lovesongs-1285e",
    storageBucket: "lovesongs-1285e.appspot.com",
    messagingSenderId: "940749066428",
    appId: "1:940749066428:web:4bc067e8721fa576fe40b9",
    measurementId: "G-HLGV34NCB0"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);

  // Initialize Firebase Authentication and Firestore
  const auth = getAuth(app);
  const db = getFirestore(app);

  // Function to register a new user
  async function registerUser(email, password, username) {
    try {
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;

      // Save user info to Firestore
      await setDoc(doc(collection(db, 'users'), user.uid), {
        username: username,
        email: email,
        createdAt: serverTimestamp()
      });

      console.log('User registered successfully:', user);
    } catch (error) {
      console.error('Error registering user:', error.message);
    }
  }

  // Function to login a user
  async function loginUser(email, password) {
    try {
      const userCredential = await signInWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;
      console.log('User logged in successfully:', user);
    } catch (error) {
      console.error('Error logging in user:', error.message);
    }
  }

  // Example usage
  // registerUser('user@example.com', 'securePassword123', 'usernameExample');
  // loginUser('user@example.com', 'securePassword123');
</script>

</head>
<body>
  <h1>Register</h1>
  <form id="register-form">
    <input type="text" id="register-username" placeholder="Username" required>
    <input type="email" id="register-email" placeholder="Email" required>
    <input type="password" id="register-password" placeholder="Password" required>
    <button type="submit">Register</button>
  </form>

  <h1>Login</h1>
  <form id="login-form">
    <input type="email" id="login-email" placeholder="Email" required>
    <input type="password" id="login-password" placeholder="Password" required>
    <button type="submit">Login</button>
  </form>

  <script type="module">
    // Your existing Firebase setup and functions here

    // Handle register form submission
    document.getElementById('register-form').addEventListener('submit', async (event) => {
      event.preventDefault();
      const username = document.getElementById('register-username').value;
      const email = document.getElementById('register-email').value;
      const password = document.getElementById('register-password').value;
      await registerUser(email, password, username);
    });

    // Handle login form submission
    document.getElementById('login-form').addEventListener('submit', async (event) => {
      event.preventDefault();
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      await loginUser(email, password);
    });
  </script>
</body>
</html>
